<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
<title>Python Runner</title>
<script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>

<style>
body {
    margin: 0;
    background: #0d1117;
    color: #e6edf3;
    font-family: system-ui;
}

.header {
    display: flex;
    justify-content: space-between;
    padding: 16px 32px;
    border-bottom: 1px solid #30363d;
}

.btn {
    background: #21262d;
    border: 1px solid #30363d;
    padding: 8px 14px;
    border-radius: 6px;
    color: white;
    cursor: pointer;
}

.btn.run {
    background: #238636;
    border: none;
}

.main {
    display: grid;
    grid-template-columns:1fr 1fr;
    height: calc(100vh - 60px);
}

.panel {
    padding: 20px;
    overflow: auto;
}

.code {
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 10px;
    padding: 20px;
    white-space: pre;
    font-family: monospace;
}

.terminal {
    background: black;
    color: #00ff9c;
    border-radius: 10px;
    padding: 20px;
    white-space: pre;
    font-family: monospace;
}
</style>
</head>

<body>

<div class="header">
    <span id="title"></span>
    <div>
        <button class="btn" onclick="location='index.html'">Back</button>
        <button class="btn run" onclick="run()">▶ Run</button>
    </div>
</div>

<div class="main">
    <div class="panel">
        <div id="code" class="code">Loading…</div>
    </div>
    <div class="panel">
        <div id="output" class="terminal"></div>
    </div>
</div>

<script>
    let pyodide = null;
    let code = "";

    async function load() {
        const params = new URLSearchParams(window.location.search);
        const file = params.get("file");

        document.getElementById("title").textContent = file;

        try {
    const r = await fetch(file);
            if (!r.ok) throw "File not found: " + file;
    code = await r.text();
            document.getElementById("code").textContent = code;
        } catch (e) {
            document.getElementById("code").textContent = "ERROR loading file:\n" + e;
            return;
        }

        pyodide = await loadPyodide();
}

    async function run() {
        const out = document.getElementById("output");
        out.textContent = "";

        if (!pyodide) {
            out.textContent = "Pyodide not loaded yet";
            return;
        }

        pyodide.setStdout({batched: s => out.textContent += s});
        pyodide.setStderr({batched: s => out.textContent += s});

        try {
    await pyodide.runPythonAsync(code);
        } catch (e) {
            out.textContent += "\n" + e;
        }
}

load();
</script>

</body>
</html>
