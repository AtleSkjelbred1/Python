<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
<title>Python Runner</title>
<script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    background: #0d1117;
    color: #e6edf3;
    font-family: system-ui;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 32px;
    border-bottom: 1px solid #30363d;
}

.btn {
    background: #21262d;
    border: 1px solid #30363d;
    padding: 8px 14px;
    border-radius: 6px;
    color: white;
    cursor: pointer;
}

/* Green Run button */
.btn.run {
    background: #238636 !important;
    border: none;
}

.btn.run:hover {
    background: #2ea043 !important;
}

.main {
    display: grid;
    grid-template-columns:1fr 1fr;
    height: calc(100vh - 60px);
}

.panel {
    padding: 20px;
    overflow: auto;
}

.code {
    background: #161b22;
    border: 1px solid #30363d;
    border-radius: 10px;
    padding: 20px;
    font-family: JetBrains Mono;
    white-space: pre;
}

.terminal {
    background: black;
    color: #00ff9c;
    border-radius: 10px;
    padding: 20px;
    white-space: pre;
    font-family: JetBrains Mono;
}
</style>
</head>

<body>

<div class="header">
    <span id="title"></span>
    <div>
        <button class="btn" onclick="location='index.html'">Back</button>
        <button class="btn run" onclick="run()">â–¶ Run</button>
    </div>
</div>

<div class="main">
    <div class="panel">
        <div id="code" class="code"></div>
    </div>
    <div class="panel">
        <div id="output" class="terminal"></div>
    </div>
</div>

<script>
    let pyodide, code;

    async function load() {
        const file = new URLSearchParams(location.search).get("file");
        title.textContent = file;
        const r = await fetch(file);
        code = await r.text();
        codeEl.textContent = code;
        pyodide = await loadPyodide();
}

    async function run() {
        output.textContent = "";
        pyodide.setStdout({batched: s => output.textContent += s});
        pyodide.setStderr({batched: s => output.textContent += s});
        await pyodide.runPythonAsync(code);
    }

    const codeEl = document.getElementById("code");
    const output = document.getElementById("output");
    const title = document.getElementById("title");

load();
</script>

</body>
</html>
