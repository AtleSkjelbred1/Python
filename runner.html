<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<title>Python Runner</title>
<script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">

<style>
    :root {
        --bg: #0d1117;
        --panel: #161b22;
        --border: #30363d;
        --text: #e6edf3;
        --muted: #8b949e;
        --accent: #58a6ff;
        --terminal: #000;
        --green: #00ff9c;
    }

    * {
        box-sizing: border-box;
    }

body {
    margin: 0;
    background: var(--bg);
    color: var(--text);
    font-family: Inter, sans-serif;
}

    /* Header */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 32px;
        border-bottom: 1px solid var(--border);
    }

    .header h1 {
        margin: 0;
        font-size: 22px;
    }

    .btn {
        background: var(--panel);
        border: 1px solid var(--border);
        color: var(--text);
        padding: 10px 18px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        transition: 0.2s;
}

    .btn:hover {
        background: #1f2933;
    }

    .btn.run {
        background: #238636;
        border: none;
    }

    .btn.run:hover {
        background: #2ea043;
}

    /* Layout */
    .main {
        display: grid;
        grid-template-columns: 1fr 1fr;
        height: calc(100vh - 70px);
}

    /* Panels */
.panel {
    padding: 24px;
    overflow: auto;
}

    .panel h3 {
        margin-top: 0;
        margin-bottom: 14px;
        color: var(--muted);
    }

    /* Code editor */
.code {
    background: var(--panel);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    font-family: 'JetBrains Mono', monospace;
    white-space: pre;
    font-size: 14px;
    line-height: 1.6;
}

    /* Terminal */
.terminal {
    background: var(--terminal);
    border-radius: 12px;
    padding: 20px;
    font-family: 'JetBrains Mono', monospace;
    white-space: pre;
    font-size: 14px;
    color: var(--green);
    box-shadow: inset 0 0 30px rgba(0, 255, 150, .1);
}

    /* Run animation */
    .running {
        animation: glow 1s infinite alternate;
    }

    @keyframes glow {
        from {
            box-shadow: inset 0 0 10px rgba(0, 255, 150, .2);
        }
        to {
            box-shadow: inset 0 0 30px rgba(0, 255, 150, .5);
        }
}
</style>
</head>

<body>

<div class="header">
    <h1 id="title">Loading...</h1>
    <div>
        <button class="btn" onclick="goBack()">← Back</button>
        <button class="btn run" onclick="run()">▶ Run</button>
    </div>
</div>

<div class="main">
    <div class="panel">
        <h3>Code</h3>
        <div id="code" class="code"></div>
    </div>

    <div class="panel">
        <h3>Terminal</h3>
        <div id="output" class="terminal"></div>
    </div>
</div>

<script>
let pyodide, code;

async function load(){
    const params = new URLSearchParams(window.location.search);
    const file = params.get("file");
    document.getElementById("title").textContent = file;

    const r = await fetch(file);
    code = await r.text();
    document.getElementById("code").textContent = code;

    pyodide = await loadPyodide();
}

async function run(){
    const out = document.getElementById("output");
    out.textContent = "";
    out.classList.add("running");

    pyodide.setStdout({batched: s => out.textContent += s});
    pyodide.setStderr({batched: s => out.textContent += s});

    try {
    await pyodide.runPythonAsync(code);
    } catch (e) {
        out.textContent += "\n" + e;
    }

    out.classList.remove("running");
}

function goBack() {
    window.location = "index.html";
}

load();
</script>

</body>
</html>
